window.UserSession={_debug:null,_fetchTimeout:15e3,_refreshUserSessionState:{inProgress:!1,awaitingResult:{}},_cookies:null,loggedIn:null,processingRes:null,_cognito:{region:"us-east-1",userPoolId:"us-east-1_uG9SGX7Wd"},_profileBaseUrl:"https://profile.w3schools.com"},UserSession.onProcessingCompleted=function(e,s){if(null!==UserSession.processingRes)return e(UserSession.processingRes);var r=256;void 0===s&&(s=100);var o=setInterval((function(){if(null!==UserSession.processingRes)return clearInterval(o),e(UserSession.processingRes);--r||(clearInterval(o),e({error:{code:"USPCLT",description:"User session processing completed lookup timeout"},data:null}))}),s)},UserSession.getCognitoIssuerUrl=function(e){return"https://cognito-idp."+e.region+".amazonaws.com/"+e.userPoolId},UserSession.verifyUserSession=function(e){var s={error:{code:"FPVUS",description:'Failed performing "verifyUserSession"'},data:{}},r=UserSession.getCookie("userSession"),o=UserSession.getCookie("userSessionMeta"),i=UserSession.getCookie("accessToken"),t=void 0!==r&&r,n=void 0!==o&&o,a=void 0!==i&&i;if(!a&&!t)return s.error={code:"USNF",description:"User session not found",meta:{origin:"verifyUserSession"}},s;if(t&&"0"===r)return s.error={code:"USNF",description:"User session not found",meta:{origin:"verifyUserSession",legacy:!1,logOut:!0,flow:'Explicit "userSessionStatusCode" flag'}},s;if(t&&"-1"===r)return s.error={code:"USSBR",description:"User session should be refreshed via redirect",meta:{legacy:!0,flow:'Explicit "userSessionStatusCode" flag'}},s;if(t&&"-2"===r)return s.error={code:"USLA",description:"User should login again",meta:{legacy:!1,flow:'Explicit "userSessionStatusCode" flag'}},s;if(t&&"-3"===r)return s.error={code:"ATSBR",description:"Access token should be refreshed",meta:{legacy:!n,flow:'Explicit "userSessionStatusCode" flag'}},s;if(!n&&t&&!a)return s.error={code:"USHE",description:"User session has expired",meta:{legacy:!0}},s;if(n){var c=UserSession.getUserSessionCookieMeta();if("0"!==c.error.code)return s.error={code:"USMINV",description:"User session meta is not valid",meta:{legacy:!1,getUserSessionCookieMetaRes:c}},s;var d=UserSession.getLocalCurrentUts();if(c.data.rtexp<d)return s.error={code:"RTHE",description:"Refresh token has expired",meta:{legacy:!1}},s;if(c.data.atexp<d)return s.error={code:"ATHE",description:"Access token has expired",meta:{legacy:!1}},s}var S=UserSession.verifyAccessToken(e,i);return"0"!==S.error.code?(s.error=S.error,s):(s.data=S.data,s.error={code:"0"},s)},UserSession.verifyAccessToken=function(e,s){var r={error:{code:"FPVAT",description:'Failed performing "verifyAccessToken"'},data:{}},o=UserSession.parseAccessToken(s);if("0"!==o.error.code)return r.error=o.error,r;r.data=o.data;var i=o.data.payload,t=UserSession.getCognitoIssuerUrl(e);return i.iss!==t?(r.error={code:"ATINVCIDNM",description:"Access token is not valid. Claim issuer does not match",meta:{accessToken:s,issuer:t,claim:i}},r):"access"!==i.token_use?(r.error={code:"ATINVCUINA",description:"Access token is not valid. Claim use is not access",meta:{accessToken:s,claim:i}},r):(r.error={code:"0"},r)},UserSession.parseAccessToken=function(e,s){var r={error:{code:"0"},data:{}};if(void 0===e||!e)return r.error={code:"USNF",description:"User session not found"},r;try{var o=e.split(".");if(o.length<3)return r.error={code:"ATINVWNOTS",description:"Access token is not valid. Wrong number of token sections",meta:{accessToken:e,accessTokenSections:o}},r;var i=void 0;if(void 0!==s&&s){var t=o[0],n=UserSession.decodeBase64UrlEncodedJwtSection(t);if("0"!==n.error.code)return r.error={code:"ATINVFDTTH",description:"Access token is not valid. Failed decoding the token header",meta:{accessToken:e,accessTokenHeaderEncodedStr:t,decodingError:n.error}},r;var a=UserSession.parseJson(n.data,["kid","alg"]);if("0"!==a.error.code)return r.error={code:"ATINVFPTH",description:"Access token is not valid. Failed parsing token header",meta:{accessToken:e,accessTokenHeaderEncodedStr:t,accessTokenHeaderDecodedStr:n.data,parseError:a.error}},r;i=a.data}var c=o[1],d=UserSession.decodeBase64UrlEncodedJwtSection(c);if("0"!==d.error.code)return r.error={code:"ATINVFDTTP",description:"Access token is not valid. Failed decoding the token payload",meta:{accessToken:e,accessTokenPayloadEncodedStr:c,decodingError:d.error}},r;var S=UserSession.parseJson(d.data,["sub","token_use","scope","auth_time","iss","exp","iat","jti","client_id","username"]);if("0"!==S.error.code)return r.error={code:"ATINVFPTP",description:"Access token is not valid. Failed parsing token payload",meta:{accessToken:e,accessTokenPayloadEncodedStr:c,accessTokenPayloadDecodedStr:d.data,parseError:S.error}},r;var u=S.data,U=parseInt(u.exp),g=new Date(1e3*U),l=UserSession.getLocalCurrentUts(),p=l+43140,f=new Date(1e3*p);r.data={rawStr:e,header:i,payload:u,expiryDto:g,expiryUts:U,ttl:43140,localCurrentUts:l,localExpiryUts:p,localExpiryDto:f}}catch(e){r.error=UserSession.getMetaPreparedFromException(e)}return r},UserSession.getUserSessionCookieMeta=function(){var e={error:{code:"1",description:'Failed performing "getUserSessionCookieMeta"'},data:{}},s=UserSession.getCookie("userSessionMeta");if(void 0===s||!s)return e.error={code:"USMCINP",description:"User session meta cookie is not present"},e;var r=UserSession.getCookieValueDecodedStr(s,1);if("0"!==r.error.code)return e.error={code:"DFUSMC",description:"Failed decoding user session meta cookie",meta:{userSessionMetaRawStr:s,userSessionMetaRawStrDecodeRes:r}},e;var o=r.data;if(0!==o.indexOf("{"))return e.error={code:"USMCINV1",description:"User session meta cookie is not valid",meta:{userSessionMetaRawStr:s,userSessionMetaRawJsonStr:o}},e;var i=UserSession.parseJson(o,["id","iss","atexp","rtexp"]);return"0"!==i.error.code?(e.error={code:"FPUSMC",description:"Failed parsing user session meta cookie",meta:{userSessionMetaRawJsonStr:o,userSessionMetaParseRes:i}},e):(e.data=i.data,e.error={code:"0"},e)},UserSession.getAccessTokenCookieLifespan=function(e,s){var r={error:{code:"1",description:'Failed performing "getAccessTokenCookieLifespan"'},data:{}},o=UserSession.getLocalCurrentUts(),i=0;if(void 0!==s)i=s.accessTokenExpiryUiUts>s.refreshTokenExpiryUiUts?s.accessTokenExpiryUiUts:s.refreshTokenExpiryUiUts;else if(void 0===e){var t=UserSession.getUserSessionCookieMeta();if("0"!==t.error.code)return r.error=t.error,r;e=t.data}return 0===i&&void 0!==e&&(i=e.atexp>e.rtexp?e.atexp:e.rtexp),r.data={currentUts:o,expiryUts:i,expiryDto:new Date(1e3*i),ttl:i-o},r.error={code:"0"},r},UserSession.changeStatusCodeInUserSessionCookies=function(e){var s=7776e3,r=UserSession.getLocalCurrentUts()+s,o=new Date(1e3*r);UserSession.resetCookie({name:"userSession",value:e,maxAge:s,expires:o});var i=UserSession.getCookie("userSessionMeta");void 0!==i&&i&&UserSession.resetCookie({name:"userSessionMeta",value:i,maxAge:s,expires:o})},UserSession.upsertActiveUserSessionCookies=function(e,s,r){var o={error:{code:"1",description:'Failed performing "upsertActiveUserSessionCookies"'},data:{}},i=7776e3,t=r.currentUiUts+i,n=new Date(1e3*t);if("undefined"==typeof sessionId){var a=UserSession.getUserSessionCookieMeta();if("0"!==a.error.code)return o.error={code:"FRUSM",description:"Failed retrieving user session meta",meta:{getUserSessionCookieMetaRes:a}},o;sessionId=a.data.id}var c={id:sessionId,iss:r.refreshTokenBaseUiUts,atexp:r.accessTokenExpiryUiUts,rtexp:r.refreshTokenExpiryUiUts},d=UserSession.getAccessTokenCookieLifespan(void 0,r);if(UserSession.logDebug("upsertActiveUserSessionCookies -> getAccessTokenCookieLifespanRes: ",d),"0"!==d.error.code)return o.error={code:"FRATCL",description:"Failed retrieving access token cookie lifespan",meta:{getAccessTokenCookieLifespanRes:d}},o;var S=UserSession.getCookieValueEncodedStr(JSON.stringify(c),1);if("0"!==S.error.code)return o.error={code:"FEUSMD",description:"Failed encoding user session meta data",meta:{userSessionMetaEncodingRes:S}},o;UserSession.resetCookie({name:"userSession",value:"1",maxAge:i,expires:n}),UserSession.resetCookie({name:"userSessionMeta",value:S.data,maxAge:i,expires:n});var u=d.data.ttl,U=d.data.expiryDto;return UserSession.resetCookie({name:"accessToken",value:e,maxAge:u,expires:U}),UserSession.resetCookie({name:"__c_u_i_1",value:s,maxAge:u,expires:U}),o.data=c,o.data.statusCode="1",o.error={code:"0"},o},UserSession.refreshUserSessionViaRedirect=function(e,s,r){UserSession.logDebug("refreshUserSessionViaRedirect -> init: ",{context:e,originUrl:s}),UserSession.setUserSessionCookieDebugMeta({origin:s,context:e,description:"refreshUserSessionViaRedirect",reason:r,prevStatusCode:UserSession.getCookie("userSession"),newStatusCode:"-1"}),UserSession.changeStatusCodeInUserSessionCookies("-1");var o=UserSession._profileBaseUrl+"/refresh-session?redirect_url="+encodeURIComponent(s);UserSession.logDebug("refreshUserSessionViaRedirect -> redirectUrl: ",o),"true"===localStorage.getItem("skipRedirect")&&UserSession._isDebugMode()||(window.location.href=o)},UserSession.restartUserSessionViaRedirect=function(e,s,r){UserSession.logDebug("restartUserSessionViaRedirect -> init: ",{context:e,originUrl:s}),UserSession.setUserSessionCookieDebugMeta({origin:s,context:e,description:"restartUserSessionViaRedirect",reason:r,prevStatusCode:UserSession.getCookie("userSession"),newStatusCode:"-2"}),UserSession.changeStatusCodeInUserSessionCookies("-2");var o=UserSession._profileBaseUrl+"/log-in?redirect_url="+encodeURIComponent(s);UserSession.logDebug("restartUserSessionViaRedirect -> redirectUrl: ",o),"true"===localStorage.getItem("skipRedirect")&&UserSession._isDebugMode()||(window.location.href=o)},UserSession._sleep=function(e,s){setTimeout(s,e)},UserSession._refreshBackendUserSession=function(e,s){UserSession.logDebug("(1) _refreshBackendUserSession -> init: ",{context:e});var r=UserSession.getCookie("accessToken");if(void 0===r||!r){var o={error:{code:"RUS_ATINPIC",description:"Access token is not present in cookies",meta:{context:e}},data:null};return UserSession.logDebug("(E1) _refreshBackendUserSession -> context, output: ",{context:e,output:o}),s(o)}UserSession.legacyFetch("POST",UserSession._profileBaseUrl+"/api/user/session",{method:"PATCH",currentUiUts:UserSession.getLocalCurrentUts()},(function(r){var o={error:{code:"RUS_FRRD",description:"Failed retrieving response data",meta:{context:e}},data:null};if("0"===r.error.code&&r.dataStr){var i=UserSession.parseJson(r.dataStr,["error","data"]);if(UserSession.logDebug("(2) _refreshBackendUserSession -> context, reqResDataParseRes: ",{context:e,reqResDataParseRes:i}),"0"!==i.error.code)return o.error={code:"RUS_RDINVFPP",description:"Response data is not valid. Failed parsing payload",meta:{context:e,reqResDataStr:r.dataStr,reqResDataParseRes:i}},UserSession.logDebug("(E2) _refreshBackendUserSession -> context, output: ",{context:e,output:o}),s(o);if(void 0===(o=i.data).error||void 0===o.error.code)return o.error={code:"RUS_RDINVMESC",description:"Response data is not valid. Missing error status code",meta:{context:e,reqRes:UserSession._getDictSnapshot(i.data,!1)}},UserSession.logDebug("(E3) _refreshBackendUserSession -> context, output: ",{context:e,output:o}),s(o);if("0"!==o.error.code)return o.error={code:"RUS_FRUS",description:"Failed refreshing user session",meta:{context:e,reqRes:UserSession._getDictSnapshot(i.data,!1)}},UserSession.logDebug("(E4) _refreshBackendUserSession -> context, output: ",{context:e,output:o}),s(o)}UserSession.logDebug("(FIN) _refreshBackendUserSession -> context, output: ",{context:e,output:o}),s(o)}))},UserSession._callbackParallelRefreshUserSessionExecutionResponse=function(e,s,r,o){if(UserSession.logDebug("(1) _callbackParallelRefreshUserSessionExecutionResponse -> context, awaitId, iteration: ",{context:e,awaitId:s,iteration:r}),void 0===UserSession._refreshUserSessionState.awaitingResult[s]){var i={error:{code:"AIDINPIQRUSSAR1",description:'Await id is not present in queue "refreshUserSessionState.awaitingResult"',meta:{context:e,awaitId:s,iteration:r}},data:{}};return UserSession.logDebug("(E1) _callbackParallelRefreshUserSessionExecutionResponse -> context, awaitId, iteration, res: ",{context:e,awaitId:s,iteration:r,res:i}),o(i)}if(30===r){delete UserSession._refreshUserSessionState.awaitingResult[s];i={error:{code:"MRRWPAPRUSER",description:'Maximum recursion reached while perfofrming "_awaitParallelRefreshUserSessionExecutionResponse"',meta:{context:e,awaitId:s,iteration:r}},data:{}};return UserSession.logDebug("(E2) _callbackParallelRefreshUserSessionExecutionResponse -> context, awaitId, iteration, res: ",{context:e,awaitId:s,iteration:r,res:i}),o(i)}setTimeout((function(){if(void 0===UserSession._refreshUserSessionState.awaitingResult[s]){var i={error:{code:"AIDINPIQRUSSAR2",description:'Await id is not present in queue "refreshUserSessionState.awaitingResult"',meta:{context:e,awaitId:s,iteration:r}},data:{}};return UserSession.logDebug("(E3) _callbackParallelRefreshUserSessionExecutionResponse -> context, awaitId, iteration, res: ",{context:e,awaitId:s,iteration:r,res:i}),o(i)}if(null!==UserSession._refreshUserSessionState.awaitingResult[s]){i=UserSession._getDictSnapshot(UserSession._refreshUserSessionState.awaitingResult[s]);delete UserSession._refreshUserSessionState.awaitingResult[s],UserSession.logDebug("(2) _callbackParallelRefreshUserSessionExecutionResponse -> context, awaitId, iteration, res: ",{context:e,awaitId:s,iteration:r,res:i}),void 0===i.error.meta&&(i.error.meta={}),i.error.meta.context=e,i.error.meta.awaitId=s,i.error.meta.iteration=r,o(i)}else UserSession._callbackParallelRefreshUserSessionExecutionResponse(e,s,++r,o)}),500)},UserSession._awaitParallelRefreshUserSessionExecutionResponse=function(e,s,r){UserSession._callbackParallelRefreshUserSessionExecutionResponse(e,s,0,(function(o){"0"!==o.error.code&&0!==o.error.code.indexOf("RUS_")&&(o.error.code="RUS_"+o.error.code),UserSession.logDebug("_awaitParallelRefreshUserSessionExecutionResponse -> context, awaitId, res: ",{context:e,awaitId:s,res:o}),r(o)}))},UserSession.refreshUserSession=function(e,s,r,o){if(UserSession.logDebug("(1) refreshUserSession -> init: ",{context:e,refreshUserSessionState:UserSession._getDictSnapshot(UserSession._refreshUserSessionState),_altRefreshBackendUserSession:r,_sleepBeforeInit:o}),void 0!==o&&o>0)return UserSession._sleep(o,UserSession.refreshUserSession.bind(null,e,s,r,void 0));if(UserSession._refreshUserSessionState.inProgress){var i=UserSession.getLocalCurrentUtus()+"";return UserSession._refreshUserSessionState.awaitingResult[i]=null,UserSession._awaitParallelRefreshUserSessionExecutionResponse(e,i,s)}UserSession._refreshUserSessionState.inProgress=!0,(void 0!==r?r:UserSession._refreshBackendUserSession)(e,(function(r){var o=r,i="0"===o.error.code&&void 0!==o.data.recentlyConsumed&&o.data.recentlyConsumed;if(i){var t=UserSession.verifyUserSession({cognitoCfg:UserSession._cognito});"0"!==t.error.code&&(o.error={code:"RUS_RSTWCRBNWSCBF",description:"Refresh session tokens were consumed recently but no working session can be found",meta:{context:e,verifyUserSessionRes:t}})}if("0"===o.error.code&&!i){var n=UserSession.upsertActiveUserSessionCookies(o.data.accessToken,o.data.userInfoCookie,o.data.sessionLifespan);UserSession.logDebug("(2) refreshUserSession -> context, upsertActiveUserSessionCookiesRes: ",{context:e,upsertActiveUserSessionCookiesRes:n}),"0"!==n.error.code&&(o.error={code:"RUS_FUAUSC",description:"Failed upserting active user session cookies",meta:{context:e,upsertActiveUserSessionCookiesRes:n}})}UserSession.logDebug("(3) refreshUserSession -> context, output: ",{context:e,output:o}),"0"!==o.error.code&&(UserSession.logDebug("(4) refreshUserSession -> new log-in required -> context, output: ",{context:e,output:o}),UserSession.setUserSessionCookieDebugMeta({origin:window.location.href,context:e,description:"refreshUserSession",reason:o,prevStatusCode:UserSession.getCookie("userSession"),newStatusCode:"-2"}),UserSession.changeStatusCodeInUserSessionCookies("-2")),void 0===o.error.meta&&(o.error.meta={}),o.error.meta.context=e,UserSession._refreshUserSessionState.inProgress=!1,UserSession.logDebug("(5) refreshUserSession -> before return -> context, refreshUserSessionState: ",{context:e,refreshUserSessionState:UserSession._getDictSnapshot(UserSession._refreshUserSessionState)});var a=Object.keys(UserSession._refreshUserSessionState.awaitingResult);if(a.length)for(var c=0;c<a.length;c++){var d=a[c];UserSession._refreshUserSessionState.awaitingResult[d]=o}s(o)}))},UserSession.userSessionRedirectionLogicHandler=function(e){UserSession.logDebug("userSessionRedirectionLogicHandler -> userSessionVerificationRes: ",e),"0"!==e.error.code&&("USSBR"===e.error.code||"USHE"===e.error.code||"ATHE"===e.error.code||"ATSBR"===e.error.code?void 0!==e.error.meta&&void 0!==e.error.meta.legacy&&e.error.meta.legacy&&UserSession.refreshUserSessionViaRedirect("userSessionRedirectionLogicHandler",window.location.href,e):"USLA"!==e.error.code&&"USMINV"!==e.error.code&&"RTHE"!==e.error.code&&0!==e.error.code.indexOf("RUS_")||UserSession.restartUserSessionViaRedirect("userSessionRedirectionLogicHandler",window.location.href,e))},UserSession.processUserSession=function(e,s){void 0===s&&(s=!1);var r=UserSession._cognito,o=UserSession.verifyUserSession(r);UserSession.logDebug("processUserSession -> userSessionVerificationRes: ",o),"USSBR"===o.error.code||"USHE"===o.error.code||"ATHE"===o.error.code||"ATSBR"===o.error.code?o.error.meta.legacy?(UserSession.processingRes=o,UserSession.loggedIn="0"===o.error.code,UserSession.logDebug("processUserSession -> loggedIn: ",UserSession.loggedIn),s&&UserSession.userSessionRedirectionLogicHandler(o),e(o)):UserSession.refreshUserSession("UserSession.processUserSession",(function(i){"0"===i.error.code?o=UserSession.verifyUserSession(r):(void 0===(o=i).error.meta&&(o.error.meta={}),o.error.meta.origin="refreshUserSession"),UserSession.logDebug("processUserSession -> refreshUserSession -> userSessionVerificationRes: ",o),UserSession.processingRes=o,UserSession.loggedIn="0"===o.error.code,UserSession.logDebug("processUserSession -> loggedIn: ",UserSession.loggedIn),s&&UserSession.userSessionRedirectionLogicHandler(o),e(o)})):(UserSession.processingRes=o,UserSession.loggedIn="0"===o.error.code,UserSession.logDebug("processUserSession -> loggedIn: ",UserSession.loggedIn),s&&UserSession.userSessionRedirectionLogicHandler(o),e(o))},UserSession._getUserSessionCookieDebugMeta=function(){var e={error:{code:"1",description:'Failed performing "_getUserSessionCookieDebugMeta"'},data:{}},s=UserSession.getCookie("userSessionDebugMeta");if(void 0===s||!s)return e.error={code:"USDMCINP",description:"User session debug meta cookie is not present"},e;var r=UserSession.getCookieValueDecodedStr(s);if("0"!==r.error.code)return e.error={code:"DFUSDMC",description:"Failed decoding user session debug meta cookie",meta:{userSessionDebugMetaRawStr:s,userSessionDebugMetaRawStrDecodeRes:r}},e;var o=r.data;if(0!==o.indexOf("{"))return e.error={code:"USDMCINV1",description:"User session debug meta cookie is not valid",meta:{userSessionDebugMetaRawStr:s,userSessionDebugMetaRawJsonStr:o}},e;var i=UserSession.parseJson(o);return"0"!==i.error.code?(e.error={code:"FPUSDMC",description:"Failed parsing user session debug meta cookie",meta:{userSessionDebugMetaRawJsonStr:o,userSessionDebugMetaParseRes:i}},e):(e.data=i.data,e.error={code:"0"},e)},UserSession.setUserSessionCookieDebugMeta=function(e){if(UserSession.logDebug("setUserSessionCookieDebugMeta -> debugMeta: ",e),UserSession._isDebugMode()){var s=UserSession.getLocalCurrentUts(),r=7776e3,o=new Date(1e3*(s+r)),i=UserSession._getUserSessionCookieDebugMeta();"0"===i.error.code&&(e.prevDebugMeta=i.data),e.currentUts=s,e.currentDtfs=new Date(1e3*s).toString();var t=UserSession.getCookieValueEncodedStr(JSON.stringify(e));UserSession.logDebug("setUserSessionCookieDebugMeta -> userSessionDebugMetaEncodingRes: ",t),"0"===t.error.code&&UserSession.resetCookie({name:"userSessionDebugMeta",value:t.data,maxAge:r,expires:o})}},UserSession._isDebugMode=function(){return null!==this._debug||("true"===UserSession.getCookie("UserSession.debug")||"true"===localStorage.getItem("UserSession.debug")?this._debug=!0:this._debug=!1),this._debug},UserSession.getLocalCurrentUts=function(){return Math.floor((new Date).getTime()/1e3)},UserSession.getLocalCurrentUtus=function(){return(new Date).getTime()},UserSession.logDebug=function(e,s,r){UserSession._isDebugMode()&&(void 0===r&&(r=!1),void 0===s?console.log(UserSession.getLocalCurrentUtus().toString()+" UserSession -> "+e):console.log(UserSession.getLocalCurrentUtus().toString()+" UserSession -> "+e,r?s:UserSession._getDictSnapshot(s)))},UserSession.logError=function(e,s,r){void 0===r&&(r=!1),"string"==typeof e?void 0===s?console.error(UserSession.getLocalCurrentUtus().toString()+" UserSession -> "+e):console.error(UserSession.getLocalCurrentUtus().toString()+" UserSession -> "+e,r?s:UserSession._getDictSnapshot(s)):console.error(e)},UserSession.setCookie=function(e){try{var s=e.name;delete e.name;var r=e.value;delete e.value,void 0!==e.maxAge&&(void 0===e.expires&&(e.expires=new Date(1e3*(UserSession.getLocalCurrentUts()+e.maxAge))),delete e.maxAge),void 0===e.domain&&(e.domain=".w3schools.com"),void 0===e.path&&(e.path="/"),void 0===e.secure&&(e.secure=!0),void 0===e.sameSite&&(e.sameSite="strict"),UserSession.logDebug("setCookie -> cookieName, cookieVal, prs: ",{cookieName:s,cookieVal:r,prs:e}),null===UserSession._cookies&&(UserSession._cookies=Cookies),UserSession._cookies.set(s,r,e)}catch(e){var o=UserSession.getMetaPreparedFromException(e);UserSession.logDebug("setCookie -> error: ",o)}},UserSession.removeCookie=function(e){try{null===UserSession._cookies&&(UserSession._cookies=Cookies),UserSession._cookies.remove(e)}catch(e){var s=UserSession.getMetaPreparedFromException(e);UserSession.logDebug("removeCookie -> error: ",s)}},UserSession.getCookie=function(e){try{return null===UserSession._cookies&&(UserSession._cookies=Cookies),UserSession._cookies.get(e)}catch(e){var s=UserSession.getMetaPreparedFromException(e);UserSession.logDebug("getCookie -> error: ",s)}},UserSession._b64RemovePadding=function(e){return e.replace(/={1,2}$/,"")},UserSession.getCookieValueEncodedStr=function(e,s){var r={error:{code:"1",description:'Failed performing "getCookieValueEncodedStr"',meta:{rawStr:e}},data:""};try{void 0===s&&(s=2),r.data=2===s?UserSession._b64RemovePadding(btoa(encodeURIComponent(e))):btoa(e),r.error={code:"0"}}catch(s){r.error=UserSession.getMetaPreparedFromException(s),void 0===r.error.meta&&(r.error.meta={}),r.error.meta.rawStr=e,UserSession.logError("UserSession -> getCookieValueEncodedStr -> str: ",e),UserSession.logError("UserSession -> getCookieValueEncodedStr -> exc: "),UserSession.logError(s),UserSession.logError("UserSession -> getCookieValueEncodedStr -> output: ",r)}return r},UserSession._b64AddPadding=function(e){return e+Array((4-e.length%4)%4+1).join("=")},UserSession.getCookieValueDecodedStr=(e,s)=>{var r={error:{code:"1",description:'Failed performing "getCookieValueDecodedStr"',meta:{encodedStr:e}},data:""};try{void 0===s&&(s=2),r.data=2===s?decodeURIComponent(atob(UserSession._b64AddPadding(e))):atob(e),r.error={code:"0"}}catch(s){r.error=UserSession.getMetaPreparedFromException(s),void 0===r.error.meta&&(r.error.meta={}),r.error.meta.encodedStr=e,UserSession.logError("UserSession -> getCookieValueDecodedStr -> str: ",e),UserSession.logError("UserSession -> getCookieValueDecodedStr -> exc: "),UserSession.logError(s),UserSession.logError("UserSession -> getCookieValueDecodedStr -> output: ",r)}return r},UserSession.resetCookie=function(e){UserSession.removeCookie(e.name),UserSession.setCookie(e)},UserSession.getUicCookie=function(){try{var e=UserSession.getCookie("__c_u_i_1");if(void 0===e)return null;var s,r=function(e){return e.split("").reverse().join("")};s=r(e.slice(-10)+e.slice(0,-10)),s=r(atob(s+Array((4-s.length%4)%4+1).join("=")));try{s=JSON.parse(decodeURIComponent(s))}catch(e){s=JSON.parse(s)}var o=(new Date).getTime()+6e4*(new Date).getTimezoneOffset();if(void 0===s._exp)throw Error("Cookie data is not valid");if(Math.round(o/1e3)>=s._exp)throw Error("Cookie data has expired");return delete s._exp,s}catch(e){UserSession._isDebugMode()&&UserSession.logError(e)}return null},UserSession.getUserSubscriptionPlan=function(e){try{var s=UserSession.getUicCookie();if(s)return s.plan}catch(e){UserSession._isDebugMode()&&UserSession.logError(e)}return void 0===e&&(e="free"),e},UserSession.getMetaPreparedFromException=function(e){UserSession.logDebug("getMetaPreparedFromException"),UserSession._isDebugMode()&&UserSession.logError(e);var s={code:"1",description:"Internal server error"};return e instanceof Error?s.description=e.message:"string"==typeof e&&(s.description=e),s},UserSession.parseJson=function(e,s){var r={error:{code:"0"},data:{}};try{if(r.data=JSON.parse(e),void 0!==s)for(var o=0;o<s.length;o++){var i=s[o];if(void 0===r.data[i])return r.error={code:"FINPID",description:"Field is not present in data",meta:{key:i}},r}}catch(e){r.error=UserSession.getMetaPreparedFromException(e)}return r},UserSession.legacyFetch=function(e,s,r,o,i){UserSession.logDebug("legacyFetch -> method, url, data, config: ",{method:e,url:s,data:r,config:i});var t=new XMLHttpRequest,n={error:{code:"0"},status:0,dataStr:""},a=setTimeout((function(){n.error={code:"RWTE",description:"Request wait time exceeded"},UserSession.logDebug("legacyFetch -> timeout -> reqRes: ",n),o(n)}),UserSession._fetchTimeout);if(t.onreadystatechange=function(){4==this.readyState&&(clearTimeout(a),n.status=this.status,n.dataStr=this.responseText,void 0!==n.status&&n.status?401==n.status?n.error={code:"UNAUTHORIZED",description:"Request unauthorized"}:n.status>=200&&n.status<300||(n.error={code:"RSC_"+n.status,description:void 0!==this.statusText&&this.statusText?this.statusText:"Request failed"}):n.error={code:"RTWNSC",description:"Request failed"},UserSession.logDebug("legacyFetch -> callback -> reqRes: ",n),o(n))},t.open(e,s,!0),t.withCredentials=!0,void 0!==i&&void 0!==i.headers&&i.headers.length)for(var c=0;c<i.headers.length;c++){var d=i.headers[c];t.setRequestHeader(d[0],d[1])}null!=r?(t.setRequestHeader("Content-type","application/json;charset=UTF-8"),t.send(JSON.stringify(r))):t.send()},UserSession.decodeBase64UrlEncodedJwtSection=function(e){var s={error:{code:"0"},data:""};try{e=e.replace(/-/g,"+").replace(/_/g,"/"),s.data=decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}catch(e){s.error=UserSession.getMetaPreparedFromException(e)}return s},UserSession._getDictSnapshot=function(e,s){try{return JSON.parse(JSON.stringify(e))}catch(e){console.error(e)}return void 0===s&&(s=!0),s?e:{}},UserSession._tmpMimicExpiredAccessToken=function(){if(UserSession._isDebugMode()){var e=UserSession.getUserSessionCookieMeta();if("0"===e.error.code){var s=e.data;s.atexp=s.iss,UserSession.resetCookie({name:"userSessionMeta",value:UserSession.getCookieValueEncodedStr(JSON.stringify(s),1).data}),UserSession.changeStatusCodeInUserSessionCookies(UserSession.getCookie("userSession"))}}},UserSession._tmpMimicExpiredRefreshToken=function(){if(UserSession._isDebugMode()){var e=UserSession.getUserSessionCookieMeta();if("0"===e.error.code){var s=e.data;s.atexp=s.iss,s.rtexp=s.iss,UserSession.resetCookie({name:"userSessionMeta",value:UserSession.getCookieValueEncodedStr(JSON.stringify(s),1).data}),UserSession.changeStatusCodeInUserSessionCookies(UserSession.getCookie("userSession"))}}};